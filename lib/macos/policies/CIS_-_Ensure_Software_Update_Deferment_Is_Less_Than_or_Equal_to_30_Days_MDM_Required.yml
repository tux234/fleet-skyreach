- name: CIS - Ensure Software Update Deferment Is Less Than or Equal to 30 Days (MDM Required)
  query: |
    SELECT 1 WHERE 
      EXISTS (
        SELECT 1 FROM managed_policies WHERE 
            domain='com.apple.applicationaccess' AND 
            name='enforcedSoftwareUpdateDelay' AND 
            value <= 30
        )
      AND NOT EXISTS (
        SELECT 1 FROM managed_policies WHERE 
            domain='com.apple.applicationaccess' AND 
            name='enforcedSoftwareUpdateDelay' AND 
            value > 30
        );  
  critical: false
  description: |
    Apple provides the capability to manage software updates on Apple devices through
    mobile device management. Part of those capabilities permit organizations to defer
    software updates and allow for testing. Many organizations have specialized software
    and configurations that may be negatively impacted by Apple updates. If software
    updates are deferred, they should not be deferred for more than 30 days.
    This control only verifies that deferred software updates are not deferred for more than 30 days.
  resolution: Ask your system administrator to deploy an MDM profile configures update deferment to a value of 30 days or less.
  platform: darwin
