- name: CIS - Ensure Show Wi-Fi status in Menu Bar Is Enabled (MDM Required)
  query: |
    SELECT 1 WHERE 
      EXISTS (
        SELECT 1 FROM managed_policies WHERE 
            domain='com.apple.controlcenter' AND 
            name='WiFi' AND 
            value = 18
        )
      AND NOT EXISTS (
        SELECT 1 FROM managed_policies WHERE 
            domain='com.apple.controlcenter' AND 
            name='WiFi' AND 
            value != 18
        );  
  critical: false
  description: |
    The Wi-Fi status in the menu bar indicates if the system's wireless internet capabilities are enabled.
    If so, the system will scan for available wireless networks in order to connect.
    Enabling "Show Wi-Fi status in menu bar" is a security awareness method that helps mitigate public area
    wireless exploits by making the user aware of their wireless connectivity status.
  resolution: |
    Automated method:
    Ask your system administrator to deploy an MDM profile that enables the Wi-Fi status in the menu bar.
    Create or edit a configuration profile with the following information:
    1. The `PayloadType` string is `com.apple.controlcenter`.
    2. The key to include is `WiFi`.
    3. The key must be set to `<integer>18</integer>`.
  platform: darwin
