- name: CIS - Ensure Printer Sharing is Disabled
  query: |
    SELECT 1 WHERE NOT EXISTS (
      SELECT * FROM file_lines WHERE
        path = '/etc/cups/cupsd.conf' AND
        line LIKE '%Allow @LOCAL%'
      );
  critical: false
  description: |
    By enabling Printer Sharing, the computer is set up as a
    print server to accept print jobs from other computers.
    Dedicated print servers or direct IP printing should be used instead.
    Disabling Printer Sharing mitigates the risk of attackers
    attempting to exploit the print server to gain access to the system.
  resolution: |
    Graphical Method:
    1. Open System Settings
    2. Select General
    3. Select Sharing
    4. Set Printer Sharing to disabled
  platform: darwin
