- name: CIS - Ensure an Administrator Account Cannot Login to Another User's Active and Locked Session (Fleetd Required)
  query: |
    SELECT 1 WHERE EXISTS (
      SELECT JSON_EXTRACT(json_result, '$.rule') AS rule
      FROM authdb
      WHERE right_name = 'system.login.screensaver' AND 
      rule LIKE '%authenticate-session-owner%'
    );
  critical: false
  description: |
    Disabling the administrator's and/or user's ability to log into another user's active and locked session prevents
    unauthorized persons from viewing potentially sensitive and/or personal information.
  resolution: |
    Automated method:
    Ask your system administrator to deploy a script that runs the following:
      /usr/bin/sudo /usr/bin/security authorizationdb write system.login.screensaver authenticate-session-owner
  platform: darwin
