- name: CIS - Ensure Show Full Website Address in Safari Is Enabled (MDM Required)
  query: |
    SELECT 1 WHERE 
      EXISTS (
        SELECT 1 FROM managed_policies WHERE 
            domain='com.apple.Safari' AND 
            name='ShowFullURLInSmartSearchField' AND 
            (value = 1 OR value = 'true') 
        )
      AND NOT EXISTS (
        SELECT 1 FROM managed_policies WHERE 
            domain='com.apple.Safari' AND 
            name='ShowFullURLInSmartSearchField' AND 
            (value != 1 AND value != 'true')
        );  
  critical: false
  description: |
    Attackers use websites with malicious or unwanted content to exploit the user or the computer. Part of the attack chain is to lure someone to load their content rather than the desired content. In order to reduce the risk in interacting with unwanted content the full website address should always be displayed in Safari.
  resolution: |
    Graphical Method:
    Perform the following steps to set Safari to show full website addresses:
      1. Open Safari
      2. Select Safari from the menu bar
      3. Select Settings
      4. Select Security
      5. Set Show full website address to enabled
    Automated method:
    Profile Method:
    Create or edit a configuration profile with the following information:
      1. The PayloadType string is com.apple.Safari
      2. The key to include is ShowFullURLInSmartSearchField 
      3. The key must be set to: <true/>
  platform: darwin
