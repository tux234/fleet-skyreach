- name: CIS - Ensure Automatic Login Is Disabled (MDM Required)
  query: |
    SELECT 1 WHERE 
      EXISTS (
        SELECT 1 FROM managed_policies WHERE 
            domain='com.apple.loginwindow' AND 
            name='com.apple.login.mcx.DisableAutoLoginClient' AND 
            (value = 1 OR value = 'true')
        )
      AND NOT EXISTS (
        SELECT 1 FROM managed_policies WHERE 
            domain='com.apple.loginwindow' AND 
            name='com.apple.login.mcx.DisableAutoLoginClient' AND 
            (value != 1 AND value != 'true')
        );  
  critical: false
  description: |
    The automatic login feature saves a user's system access credentials and bypasses the login screen. Instead, the system automatically loads to the user's desktop screen
  resolution: |
    Automated method:
    Ask your system administrator to deploy an MDM profile that Ensure Automatic Login Is Disabled
    Graphical method:
      Perform the following steps to ensure Automatic Login Is Disabled:
        1. Open System Settings
        2. Select Users & Groups
        3. Set Automatic login in as... to Off
    Profile Method:
        Create or edit a configuration profile with the following information:
        1. The Payload Type string is com.apple.loginwindow
        2. The key to include is com.apple.login.mcx.DisableAutoLoginClient 
        3. The key must be set to <true/>
  platform: darwin
