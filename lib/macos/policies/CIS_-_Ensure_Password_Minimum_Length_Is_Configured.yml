- name: CIS - Ensure Password Minimum Length Is Configured
  query: |
    SELECT 1 
    FROM (
    SELECT cast(lengthtxt as integer(2)) minlength 
    FROM (
    SELECT SUBSTRING(length, 1, 2) AS lengthtxt 
    FROM (
    SELECT policy_description, policy_identifier, split(policy_content, '{', 1) AS length 
    FROM password_policy 
    WHERE policy_identifier LIKE '%minLength')) 
    WHERE minlength >= 15);
  critical: false
  description: |
    A minimum password length is the fewest number of characters a password can contain to meet a system's requirements. Ensure that a minimum of a 15-character password is part of the password policy on the computer. Where the confidentiality of encrypted information in FileVault is more of a concern, requiring a longer password or passphrase may be sufficient rather than imposing additional complexity requirements that may be self-defeating.
  resolution: |
    Automated method:
    Ask your system administrator to deploy an MDM profile that disables Guest Account.
    Profile Method:
    Create or edit a configuration profile with the following information:
      1. The PayloadType string is com.apple.mobiledevice.passwordpolicy 
      2. The key to include is minLength
      3. The key must be set to <integer><valueâ‰¥15></integer>
  platform: darwin
