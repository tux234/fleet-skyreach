- name: CIS - Ensure AirDrop Is Disabled (MDM Required)
  query: |
    SELECT 1 WHERE 
      EXISTS (
        SELECT 1 FROM managed_policies WHERE 
            domain='com.apple.applicationaccess' AND 
            name='allowAirDrop' AND 
            (value = 0 OR value = 'false')
        )
      AND NOT EXISTS (
        SELECT 1 FROM managed_policies WHERE 
            domain='com.apple.applicationaccess' AND 
            name='allowAirDrop' AND 
            (value != 0 AND value != 'false')
        );  
  critical: false
  description: |
    AirDrop can allow malicious files to be downloaded from unknown sources.
    Contacts Only limits may expose personal information to devices in the same area.
  resolution: |
    Ask your system administrator to deploy an MDM profile that disables AirDrop.
    Create or edit a configuration profile with the following information:
      1. The PayloadType string is com.apple.applicationaccess
      2. The key to include is allowAirDrop
      3. The key must be set to <false/>
  platform: darwin
