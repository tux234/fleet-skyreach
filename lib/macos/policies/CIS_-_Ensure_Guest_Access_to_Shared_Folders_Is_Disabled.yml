- name: CIS - Ensure Guest Access to Shared Folders Is Disabled
  query: SELECT 1 from plist where path = '/Library/Preferences/SystemConfiguration/com.apple.smb.server.plist' AND key = 'AllowGuestAccess' AND value = 0;
  critical: false
  description: Allowing guests to connect to shared folders enables users to access selected shared folders and their contents from different computers on a network
  resolution: |
    Automated method:
      Ask your system administrator to deploy the following script which will disable guest users from access to shared folders:
      /usr/bin/sudo /usr/sbin/sysadminctl -smbGuestAccess off
    Graphical Method:
      Perform the following steps to no longer allow guest user access to shared folders:
        1. Open System Settings
        2. Select Users & Groups
        3. Select the i next to the Guest User
        4. Set Allow guests to connect to shared folders to disabled
  platform: darwin
