- name: CIS - Ensure Wake for Network Access Is Disabled (Fleetd Required)
  query: |
    SELECT 1 FROM (SELECT
      COALESCE(JSON_EXTRACT(
          JSON_EXTRACT(json_result, '$.AC Power:'),
          '$.womp'
      ), '') AS womp_ac,
      COALESCE(JSON_EXTRACT(
          JSON_EXTRACT(json_result, '$.Battery Power:'),
          '$.womp'
      ), '') AS womp_battery
    FROM pmset WHERE getting = 'custom' AND womp_battery != '1' AND womp_ac != '1');
  critical: false
  description: |
    Wake for Network Access allows the computer to take action when the user is not present and the computer
    is in energy saving mode. These tools require FileVault to remain unlocked and fully rejoin known networks.

    Disabling this feature mitigates the risk of an attacker remotely waking the system and gaining access.
  resolution: |
    Automated method:
    Ask your system administrator to deploy a script that runs the following command to turn off
    Wake on  on the device:
    /usr/bin/sudo /usr/bin/pmset -a womp 0
  platform: darwin
